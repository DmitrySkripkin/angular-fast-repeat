angular.module("gc.fastRepeat",[]).directive("fastRepeat",["$compile","$parse",function(a,b){"use strict";function c(a,b){return a.slice&&"$$"==a.slice(0,2)?void 0:b}function d(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}var e=0,f=!1;return{restrict:"A",scope:!1,transclude:"element",priority:1e4,compile:function(){return function(a,g,h,i,j){var k,l=h.fastRepeat.split(" in "),m=l[1],n=l[0],o={},p=a.$new(!1);j(p,function(h,i){function j(a){return i[n]=a,i.$digest(),h.attr("fast-repeat-id",a.$$fastRepeatId),h.clone()}var l=b(m);a.$watch(function(a){return JSON.stringify(l(a),c)},function(b){b=l(a),f&&(k=d()),a.$$postDigest(function(){var a={};angular.forEach(b,function(b){b.$$fastRepeatId||(b.$$fastRepeatId=++e),a[b.$$fastRepeatId]=b}),angular.forEach(o,function(b,c){a[c]||b.el.detach()});var c=g;angular.forEach(b,function(a){var b=a.$$fastRepeatId,d=o[b];if(d){if(!d.compiled&&!angular.equals(d.copy,a)){var e=j(a);d.el.replaceWith(e),d.el=e,d.copy=angular.copy(a)}}else d={copy:angular.copy(a),item:a,el:j(a)},o[b]=d;c.after(d.el.last()),c=d.el.last()}),f&&(k=d()-k,console.log("Total time: ",k,"ms"),console.log("time per row: ",k/b.length))})},!1)}),g.parent().on("click","[fast-repeat-id]",function(b){var c=$(this),d=c.attr("fast-repeat-id"),e=a.$new(!1),f=c.find("*").index(b.target);e[n]=o[d].item,j(e,function(a){c.replaceWith(a),o[d]={compiled:!0,el:a},setTimeout(function(){f>=0?a.find("*").eq(f).trigger("click"):a.trigger("click")},0)})})}}}}]);