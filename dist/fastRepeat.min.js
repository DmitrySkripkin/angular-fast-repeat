angular.module("gc.fastRepeat",[]).directive("fastRepeat",["$compile","$parse","$animate",function(a,b,c){"use strict";function d(a,b){return a.slice&&"$$"==a.slice(0,2)?void 0:b}function e(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}var f=0,g=!1;return{restrict:"A",scope:!1,transclude:"element",priority:1e4,compile:function(){return function(a,h,i,j,k){var l,m=i.fastRepeat.split(" in "),n=m[1],o=m[0],p=b(n),q={},r=a.$new(!1);r[o]=p(a)[0]||{},k(r,function(b,i){function j(a){return i[o]=a,i.$digest(),b.attr("fast-repeat-id",a.$$fastRepeatId),b.clone()}c.enabled(!1,b),a.$watch(function(a){return JSON.stringify(p(a),d)},function(b){b=p(a),g&&(l=e()),a.$$postDigest(function(){var a={};angular.forEach(b,function(b){b.$$fastRepeatId||(b.$$fastRepeatId=++f),a[b.$$fastRepeatId]=b}),angular.forEach(q,function(b,c){a[c]||b.el.detach()});var c=h;angular.forEach(b,function(a){var b=a.$$fastRepeatId,d=q[b];if(d){if(!d.compiled&&!angular.equals(d.copy,a)){var e=j(a);d.el.replaceWith(e),d.el=e,d.copy=angular.copy(a)}}else d={copy:angular.copy(a),item:a,el:j(a)},q[b]=d;c.after(d.el.last()),c=d.el.last()}),g&&(l=e()-l,console.log("Total time: ",l,"ms"),console.log("time per row: ",l/b.length))})},!1)}),h.parent().on("click","[fast-repeat-id]",function(b){var c=$(this),d=c.attr("fast-repeat-id"),e=a.$new(!1),f=c.find("*").index(b.target);e[o]=q[d].item;k(e,function(a,b){b.$$postDigest(function(){c.replaceWith(a),q[d]={compiled:!0,el:a},f>=0?a.find("*").eq(f).trigger("click"):a.trigger("click")})});e.$digest()})}}}}]);